CREATE DATABASE TECHSHOP;

USE TECHSHOP;

CREATE TABLE MAU (
	ID VARCHAR(10) PRIMARY KEY,
	TEN NVARCHAR(20),
	MAMAU VARCHAR(6)
);

CREATE TABLE QUOCGIA (
	ID VARCHAR(10) PRIMARY KEY,
	TEN NVARCHAR(100)
);

CREATE TABLE TINH (
	ID VARCHAR(10) PRIMARY KEY,
	TEN NVARCHAR(100),
	QUOCGIA VARCHAR(10)
);

CREATE TABLE KHACHHANG (
	ID VARCHAR(10) PRIMARY KEY,
	TEN NVARCHAR(100),
	NGAYSINH DATE,
	GIOITINH INT CONSTRAINT KHACHHANG_GIOITINH check(GIOITINH in (0, 1)), --NAM: O, NU: 1
	SDT VARCHAR(10),
	EMAIL VARCHAR(100),
	MAGIOITHIEU INT,
	NGAYTHAMGIA DATE,
	DIACHI NVARCHAR(100),
	TINH VARCHAR(10),
);

CREATE TABLE NHANVIEN (
	ID VARCHAR(10) PRIMARY KEY,
	TEN NVARCHAR(100),
	NGAYSINH DATE,
	GIOITINH INT CONSTRAINT NHANVIEN_GIOITINH check(GIOITINH in (0, 1)), --NAM: O, NU: 1
	SDT VARCHAR(10),
	EMAIL VARCHAR(100),
	NGAYLAMVIEC DATE,
	HESO FLOAT,
	PHUCAP INT,
	DIACHI NVARCHAR(100),
	TINH VARCHAR(10),
	CONGVIEC VARCHAR(10)
);

CREATE TABLE LOAISANPHAM (
	ID VARCHAR(10) PRIMARY KEY,
	TEN NVARCHAR(100)
);

CREATE TABLE SANPHAM (
	ID VARCHAR(10) PRIMARY KEY,
	TEN NVARCHAR(100),
	GIA INT,
	DAI FLOAT,
	RONG FLOAT,
	CAO FLOAT,
	MAU VARCHAR(10),
	KHOILUONG FLOAT,
	SOLUONG INT,
	NGAYNHAP DATE,
	THONGTIN NVARCHAR(1000),
	LOAISANPHAM VARCHAR(10),
	NHACUNGCAP VARCHAR(10)
);

CREATE TABLE NHACUNGCAP (
	ID VARCHAR(10) PRIMARY KEY,
	TEN NVARCHAR(100),
	DIACHI NVARCHAR(100),
	TINH VARCHAR(10),
	SDT NVARCHAR(10),
	EMAIL VARCHAR(100),
	THONGTIN NVARCHAR(1000)
);

CREATE TABLE CONGVIEC (
	ID VARCHAR(10) PRIMARY KEY,
	TEN NVARCHAR(100),
	LUONG INT,
	THONGTIN NVARCHAR(1000)
);

CREATE TABLE HOADON (
	ID VARCHAR(10) PRIMARY KEY,
	NGAYTAO DATE,
	NHANVIEN VARCHAR(10),
	KHACHHANG VARCHAR(10)
);

CREATE TABLE CHITIETHOADON (
	ID VARCHAR(10),
	SANPHAM VARCHAR(10),
	SOLUONG INT,
	CONSTRAINT CHITIETHOADON_PK PRIMARY KEY(ID, SANPHAM)
);

ALTER TABLE TINH ADD
	CONSTRAINT TINH_QUOCGIA_FK FOREIGN KEY(QUOCGIA) REFERENCES QUOCGIA(ID);

ALTER TABLE NHACUNGCAP ADD
	CONSTRAINT NHACUNGCAP_TINH_FK FOREIGN KEY(TINH) REFERENCES TINH(ID);

ALTER TABLE KHACHHANG ADD
	CONSTRAINT KHACHHANG_TINH_FK FOREIGN KEY(TINH) REFERENCES TINH(ID);

ALTER TABLE NHANVIEN ADD
	CONSTRAINT NHANVIEN_CONGVIEC_FK FOREIGN KEY(CONGVIEC) REFERENCES CONGVIEC(ID),
	CONSTRAINT NHANVIEN_TINH_FK FOREIGN KEY(TINH) REFERENCES TINH(ID);

ALTER TABLE SANPHAM ADD
	CONSTRAINT SANPHAM_LOAISANPHAM_FK FOREIGN KEY(LOAISANPHAM) REFERENCES LOAISANPHAM(ID),
	CONSTRAINT SANPHAM_NHACUNGCAP_FK FOREIGN KEY(NHACUNGCAP) REFERENCES NHACUNGCAP(ID),
	CONSTRAINT SANPHAM_MAU_FK FOREIGN KEY(MAU) REFERENCES MAU(ID);

ALTER TABLE HOADON ADD
	CONSTRAINT HOADON_NHANVIEN_FK FOREIGN KEY(NHANVIEN) REFERENCES NHANVIEN(ID),
	CONSTRAINT HOADON_KHACHHANG_FK FOREIGN KEY(KHACHHANG) REFERENCES KHACHHANG(ID);

ALTER TABLE CHITIETHOADON ADD
	CONSTRAINT CHITIETHOADON_ID_FK FOREIGN KEY(ID) REFERENCES HOADON(ID),
	CONSTRAINT CHITIETHOADON_SANPHAM_FK FOREIGN KEY(SANPHAM) REFERENCES SANPHAM(ID);

INSERT INTO MAU (ID, TEN, MAMAU)
	VALUES
	('M1', N'Đỏ', 'ff1100'),
	('M2', N'Đen', '000000'),
	('M3', N'Trắng', 'ffffff'),
	('M4', N'Xanh dương', '008cff'),
	('M5', N'Xanh lá cây', '31f505')

INSERT INTO QUOCGIA (ID, TEN)
	VALUES
	('QG1', N'Việt Nam'),
	('QG2', N'Lào'),
	('QG3', N'Campuchia'),
	('QG4', N'Hoa Kỳ')

INSERT INTO TINH (ID, TEN, QUOCGIA)
	VALUES
	('T1', N'Hà Nội', 'QG1'),
	('T2', N'hồ Chí Minh', 'QG1'),
	('T3', N'Gia Lai', 'QG1'),
	('T4', N'Kon Tum', 'QG1'),
	('T5', N'Califonia', 'QG4')

INSERT INTO KHACHHANG (ID, TEN, NGAYSINH, GIOITINH, SDT, EMAIL, MAGIOITHIEU, NGAYTHAMGIA, DIACHI, TINH)
	VALUES
	('KH1', N'Nguyễn Thị Như Quỳnh', '1997/11/12', 1, '0965412147', 'ntnq@gmail.com',1225744, '2019/8/7', N'72 Hùng Vương, Quang Trung', 'T1'),
	('KH2', N'Phạm Thanh Hai', '1995/10/10', 0, '0367899841', 'hai95@gmail.com', 133445, '2019/9/10', N'66 Nguyễn Tất Thành, Duy Tân', 'T1'),
	('KH3', N'Bành Kỳ Kỳ', '1994/6/1', 0, '0965412147', 'banhvanky1994@gmail.com', 1225744, '2019/8/7', N'68 Hùng Vương, Quang Trung', 'T1'),
	('KH4', N'Nguyễn Xuân Hòn', '2000/6/5', 0, '0965412147', 'honhon2k@gmail.com', 1997744, '2020/10/24', N'72 Hùng Vương, Quang Trung', 'T1'),
	('KH5', N'Thu Yến', '1997/5/4', 1, '0987987987', 'thuyencute@gmail.com', 655811, '2020/8/7', N'122 Phan Đình Phùng, Quang Trung', 'T1'),
	('KH6', N'Nguyễn Trúc Giang', '2000/12/5', 1, '039888654', 'yeugiangnhieu@gmail.com', 655811, '2020/7/18', N'Không biết, Quang Trung', 'T1')

INSERT INTO CONGVIEC (ID, TEN, LUONG, THONGTIN)
	VALUES
	('CV1', N'Quản kho', 4000000, N''),
	('CV2', N'Giữ xe', 2200000, N''),
	('CV3', N'Trông hàng', 3200000, N''),
	('CV4', N'Thu ngân', 3900000, N''),
	('CV5', N'Quản lý',	6500000, N'')

INSERT INTO NHANVIEN (ID, TEN, NGAYSINH, GIOITINH, SDT, EMAIL, NGAYLAMVIEC, HESO, PHUCAP, DIACHI, TINH, CONGVIEC)
	VALUES
	('NV1', N'Puith Naly', '2000/10/30', 1, '0398422145', 'lyyeudau@gmail.com', '2019/12/22', 1.4, 300000, N'22 Không biết, Ở đâu', 'T3', 'CV4'),
	('NV2', N'Lê Hạnh', '2000/6/12', 1, '0987541124', 'hanhdepgai@gmail.com', '2020/1/12', 1.2, 250000, N'1 Không biết, Ở đâu', 'T3', 'CV3'),
	('NV3', N'Rmar Sê', '2000/11/9', 0, '0398756412', 'smarsee@gmail.com', '2020/1/31', 1.1, 240000, N'1 Không biết, Ở đâu', 'T3', 'CV2')

INSERT INTO LOAISANPHAM (ID, TEN)
	VALUES
	('LSP1', N'Laptop'),
	('LSP2', N'Điện thoại'),
	('LSP3', N'Loa'),
	('LSP4', N'Tai nghe'),
	('LSP5', N'Sạc')

INSERT INTO NHACUNGCAP (ID, TEN, DIACHI, TINH, SDT, EMAIL, THONGTIN)
	VALUES
	('NCC1', N'Samsung', N'99 Trần Phú, Duy Tân', 'T4', '098833245', 'samsungkontum@gmail.com', N''),
	('NCC2', N'Apple', N'225 WasterLane, Wlingster', 'T5', '0666547874', 'appleinc@gmail.com', N''),
	('NCC3', N'VSmart', N'222 Nguyễn Sinh Thành, Bình Trắc', 'T1', '0366987441', 'VsmartHanoi@gmail.com', N''),
	('NCC4', N'Lenovo', N'12 Không biết, Không có', 'T2', '0388754145', 'lenovo@gmail.com', N''),
	('NCC5', N'Asus', N'13 Không biết, Không có', 'T2', '0389755781', 'asus@gmail.com', N''),
	('NCC6', N'Dell', N'24 Không biết, Không có', 'T2', '0368975145', 'dell@gmail.com', N''),
	('NCC7', N'Oppo', N'21 Không biết, Không có', 'T2', '036544781', 'oppo@gmail.com', N'')


INSERT INTO SANPHAM (ID, TEN, GIA, DAI, RONG, CAO, MAU, KHOILUONG, SOLUONG, NGAYNHAP, THONGTIN, LOAISANPHAM, NHACUNGCAP)
	VALUES
	('SP1', N'Lenovo Ideapad S145 - 14API/R3 3200U', 8320000, 327.1, 241, 19, 'M3', 1.6, 12, '2019/5/10', N'', 'LSP1', 'NCC4'),
	('SP2', N'Asus TUF FX505DT HN478T R7 3750H/8GB/512GB SSD/Win10', 19490000, 360, 262, 26, 'M2', 2.2, 6, '2020/10/16', N'', 'LSP1', 'NCC5'),
	('SP3', N'Oppo A53 4GB-128GB', 4490000, 163.9, 75.1, 8.4, 'M4', 0.186, 11, '2020/5/11', N'', 'LSP2', 'NCC6')

INSERT INTO HOADON (ID, NGAYTAO, NHANVIEN, KHACHHANG)
	VALUES
	('HD1', '2020/1/2', 'NV1', 'KH5'),
	('HD2', '2020/2/3', 'NV1', 'KH4')

INSERT INTO CHITIETHOADON (ID, SANPHAM, SOLUONG)
	VALUES
	('HD1', 'SP1', 1),
	('HD1', 'SP3', 1),
	('HD2', 'SP2', 2)